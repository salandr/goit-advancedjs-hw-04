{"version":3,"file":"commonHelpers.js","sources":["../src/api.js","../src/markup.js","../src/main.js"],"sourcesContent":["const PIXABAY_API_KEY = '40913956-3fb26abc12009e80362ea258a';\nimport axios from 'axios';\n\nexport async function fetchImages(query, pageNumber) {\n  const response = await axios.get(\n    `https://pixabay.com/api/?key=${PIXABAY_API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${pageNumber}&per_page=40`\n  );\n  return response.data;\n}\n","export function renderGallery(images, galleryContainer, gallery) {\n  const { hits } = images;\n  const markup = hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        likes,\n        views,\n        comments,\n        downloads,\n        tags,\n      }) => {\n        return `<div class=\"photo-card\">    \n                  <a href=\"${largeImageURL}\">\n                  <img class=\"searched-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" data-title=\"${tags}\"/></a>\n                  <div class=\"info\">\n                      <p class=\"info-item\">\n                          <b>Likes</b><span class=\"info-data\">${likes}</span>\n                      </p>\n                          <p class=\"info-item\">\n                      <b>Views</b><span class=\"info-data\">${views}</span>\n                      </p>\n                      <p class=\"info-item\">\n                          <b>Comments</b><span class=\"info-data\">${comments}</span>\n                      </p>\n                      <p class=\"info-item\">\n                          <b>Downloads</b><span class=\"info-data\">${downloads}\n                          </p></span>\n                  </div>\n              </div>`;\n      }\n    )\n    .join('');\n  galleryContainer.insertAdjacentHTML('beforeend', markup);\n  gallery.refresh();\n}\n\nexport function galleryLoaded() {\n  const { height: cardHeight } = document\n    .querySelector('.photo-card')\n    .getBoundingClientRect();\n  const height = window.innerHeight;\n  window.scrollBy({\n    top: height - cardHeight,\n    behavior: 'smooth',\n  });\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchImages } from './api';\nimport { renderGallery, galleryLoaded } from './markup';\n\niziToast.settings({\n  position: 'bottomRight',\n  timeout: 3000,\n  maxWidth: 300,\n});\n\nlet gallery = new SimpleLightbox('.gallery a', {\n  captionType: 'data',\n  captionDelay: 250,\n});\n\n//access elements on page\nconst galleryContainer = document.querySelector('.gallery');\nconst form = document.querySelector('.search-form');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst imgListEnd = document.querySelector('.end-of-img-list');\n//add event listeners to form and button\nform.addEventListener('submit', formSubmitHandler);\nloadMoreBtn.addEventListener('click', loadMoreBtnHandler);\n//variables to store page number and userInput respectively\nlet pageNumber;\nlet userInput;\n//submit form handler\nasync function formSubmitHandler(e) {\n  e.preventDefault();\n  pageNumber = 1; //set page number to one on each new search\n  userInput = e.target.searchQuery.value.trim(); //user input value\n  if (userInput === '') {\n    iziToast.warning({\n      message: 'Please specify search criteria!',\n    });\n    return;\n  }\n  galleryContainer.innerHTML = ''; //clear previous search gallery content\n  imgListEnd.style.display = 'none'; //hides message of the end of img list if it was shown before\n  loadMoreBtn.style.display = 'none'; //hides \"Load more\" button, if was visible before\n  try {\n    const imgs = await fetchImages(userInput, pageNumber); //fetch images based on user query\n    //check if anything found and if array is empty show message\n    if (imgs.hits.length === 0) {\n      iziToast.error({\n        message: `Sorry, there are no images matching your search query. Please try again.`,\n      });\n      e.target.searchQuery.value = '';\n      return;\n    }\n    renderGallery(imgs, galleryContainer, gallery); //render gallery, refresh Simplelightbox\n    e.target.searchQuery.value = ''; //clear input field\n    //show success message with total hits\n    iziToast.success({\n      message: `Hooray! We found ${imgs.totalHits} images`,\n    });\n    if (imgs.hits.length < 40) {\n      imgListEnd.style.display = 'block';\n      return;\n    }\n    loadMoreBtn.style.display = 'block'; //make \"Load more\" button visible\n  } catch (error) {\n    // handle error\n    iziToast.error({\n      message: `${error.message}`,\n    });\n    console.log(error.message);\n  }\n}\n//\"load more\" button handler\nasync function loadMoreBtnHandler() {\n  pageNumber++; //increase page number by 1 with each request\n  loadMoreBtn.visibility = 'hidden'; // hide \"Load more\" button\n  try {\n    const imgs = await fetchImages(userInput, pageNumber); //fetch next page images\n    renderGallery(imgs, galleryContainer, gallery); // add new images to gallery and refresh Simplelightbox\n    galleryLoaded(); //apply smooth scrolling\n    //check page number, and display message about end of list of images, requesting page 7 will result in error\n    if (pageNumber === 13) {\n      loadMoreBtn.style.display = 'none';\n      imgListEnd.style.display = 'block';\n      return;\n    }\n    //check if reached the end of images list and hide \"Load more\" button and show message\n    if (imgs.hits.length < 40 || imgs.hits.length === 0) {\n      loadMoreBtn.style.display = 'none';\n      imgListEnd.style.display = 'block';\n      return;\n    }\n    loadMoreBtn.visibility = 'visible'; //show \"Load more\" button\n  } catch (error) {\n    //handle error\n    iziToast.error({\n      message: `${error.message}`,\n    });\n    console.log(error.message);\n  }\n}\n"],"names":["PIXABAY_API_KEY","fetchImages","query","pageNumber","axios","renderGallery","images","galleryContainer","gallery","hits","markup","webformatURL","largeImageURL","likes","views","comments","downloads","tags","galleryLoaded","cardHeight","height","iziToast","SimpleLightbox","form","loadMoreBtn","imgListEnd","formSubmitHandler","loadMoreBtnHandler","userInput","imgs","error"],"mappings":"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"}